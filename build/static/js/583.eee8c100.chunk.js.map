{"version":3,"sources":["views/apps/freshlist/order/SalesReturnView.js"],"names":["SalesReturnView","args","useState","setIndex","error","setProductList","grandTotalAmt","setGrandTotalAmt","setEditdata","setUserInfo","setSalesPersonList","location","useParams","useLocation","productId","Product_Title","Qty_Sales","Qty_Return","Product_Price","OrderedListData","setOrderedListData","handleProductChangeProduct","e","index","target","name","value","list","Number","x","map","ele","price","returnQty","grandTotal","reduce","a","b","useEffect","getFromLocalData","JSON","parse","localStorage","getItem","orderItems","state","Product_MRP","setItem","console","log","Create_Sales_personList","then","res","SalesPerson","catch","err","userdata","ProductListView","_id","database","Product","userInfo","className","render","history","style","cursor","color","size","onClick","goBack","onSubmit","preventDefault","userData","myarr","i","qty","payload","partyId","userId","returnItems","mobileNumber","email","Return_amount","orderId","created_by","swal","SalesReturnProduct","item","key","lg","md","sm","type","readOnly","placeholder","Size","onChange","unitType","min","max","Ripple"],"mappings":"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","file":"static/js/583.eee8c100.chunk.js","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport xmlJs from \"xml-js\";\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  Col,\r\n  Form,\r\n  Row,\r\n  Input,\r\n  Label,\r\n  Button,\r\n} from \"reactstrap\";\r\nimport \"react-phone-input-2/lib/style.css\";\r\nimport { useParams, useLocation } from \"react-router-dom\";\r\n\r\nimport \"../../../../assets/scss/pages/users.scss\";\r\nimport {\r\n  SalesReturnProduct,\r\n  ProductListView,\r\n  Create_Sales_personList,\r\n} from \"../../../../ApiEndPoint/ApiCalling\";\r\nimport \"../../../../assets/scss/pages/users.scss\";\r\nimport { Route } from \"react-router-dom\";\r\n\r\nconst SalesReturnView = args => {\r\n  const [Index, setIndex] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [ProductList, setProductList] = useState([]);\r\n  const [grandTotalAmt, setGrandTotalAmt] = useState(0);\r\n  const [Editdata, setEditdata] = useState({});\r\n  const [UserInfo, setUserInfo] = useState({});\r\n  const [SalesPersonList, setSalesPersonList] = useState([]);\r\n  const Params = useParams();\r\n  const location = useLocation();\r\n\r\n  const [OrderedListData, setOrderedListData] = useState([\r\n    {\r\n      productId: \"\",\r\n      Product_Title: \"\",\r\n      Qty_Sales: \"\",\r\n      Qty_Return: 0,\r\n      Product_Price: \"\",\r\n    },\r\n  ]);\r\n\r\n  const handleProductChangeProduct = (e, index) => {\r\n    setIndex(index);\r\n    const { name, value } = e.target;\r\n    const list = [...OrderedListData];\r\n    list[index][name] = Number(value);\r\n    setOrderedListData(list);\r\n\r\n    let x = list?.map((ele) => {\r\n      return Number(ele?.price * ele?.returnQty);\r\n    });\r\n    let grandTotal = x?.reduce((a, b) => a + b, 0);\r\n\r\n    setGrandTotalAmt(grandTotal);\r\n  };\r\n  useEffect(() => {\r\n    let getFromLocalData = JSON.parse(\r\n      localStorage.getItem(\"OrderList\")\r\n    )?.orderItems;\r\n    if (location?.state) {\r\n      setOrderedListData(location?.state.orderItems);\r\n      let grandTotal = location?.state?.orderItems?.reduce(\r\n        (a, b) => a + b?.productId?.Product_MRP,\r\n        0\r\n      );\r\n\r\n      setGrandTotalAmt(grandTotal);\r\n      localStorage.setItem(\"EditoneProduct\", location?.state);\r\n      setEditdata(location?.state);\r\n    } else {\r\n      setOrderedListData(getFromLocalData);\r\n      let grandTotal = location?.state?.orderItems?.reduce(\r\n        (a, b) => a + b?.productId?.Product_MRP,\r\n        0\r\n      );\r\n      console.log(grandTotal);\r\n      setGrandTotalAmt(grandTotal);\r\n    }\r\n  }, []);\r\n  useEffect(() => {}, [OrderedListData]);\r\n\r\n  useEffect(() => {\r\n    Create_Sales_personList()\r\n      .then((res) => {\r\n        setSalesPersonList(res?.SalesPerson);\r\n      })\r\n      .catch((err) => console.log(err));\r\n    let userdata = JSON.parse(localStorage.getItem(\"userData\"));\r\n\r\n    ProductListView(userdata?._id, userdata?.database)\r\n      .then((res) => {\r\n        setProductList(res?.Product);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }, []);\r\n  useEffect(() => {\r\n    const userInfo = JSON.parse(localStorage.getItem(\"userData\"));\r\n    console.log(userInfo);\r\n    setUserInfo(userInfo);\r\n  }, []);\r\n\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    console.log(OrderedListData);\r\n    let userData = JSON.parse(localStorage.getItem(\"userData\"));\r\n    console.log(userData);\r\n\r\n    let myarr = OrderedListData?.map((ele, i) => {\r\n      return {\r\n        productId: ele?.productId?._id,\r\n        Qty_Sales: ele?.qty,\r\n        Qty_Return: Number(ele?.returnQty),\r\n        Product_Price: ele?.price,\r\n      };\r\n    });\r\n\r\n    let payload = {\r\n      partyId: location?.state?.partyId?._id,\r\n      userId: userData?._id,\r\n      returnItems: myarr,\r\n      mobileNumber: userData?.mobileNumber,\r\n      email: userData.email,\r\n      Return_amount: grandTotalAmt,\r\n      orderId: location?.state?._id,\r\n      created_by: userData?._id,\r\n    };\r\n\r\n    if (error) {\r\n      swal(\"Error occured while Entering Details\");\r\n    } else {\r\n      SalesReturnProduct(payload)\r\n        .then((res) => {\r\n          swal(\"Sales Returned Successfully\");\r\n\r\n          console.log(res);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <Card>\r\n          <Row className=\"m-2\">\r\n            <Col className=\"\">\r\n              <div>\r\n                <h1 className=\"\">Sales Return</h1>\r\n              </div>\r\n            </Col>\r\n            <Col>\r\n              <div className=\"float-right\">\r\n                <Route\r\n                  render={({ history }) => (\r\n                    <Button\r\n                      style={{ cursor: \"pointer\" }}\r\n                      className=\"float-right mr-1\"\r\n                      color=\"danger\"\r\n                      size=\"sm\"\r\n                      onClick={() => history.goBack()}>\r\n                      Back\r\n                    </Button>\r\n                  )}\r\n                />\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n\r\n          <CardBody>\r\n            <Form className=\"m-1\" onSubmit={submitHandler}>\r\n              {OrderedListData &&\r\n                OrderedListData?.map((item, index) => {\r\n                  console.log(item);\r\n                  return (\r\n                    <Row className=\"\" key={index}>\r\n                      <Col className=\"mb-1\" lg=\"2\" md=\"2\" sm=\"12\">\r\n                        <div className=\"\">\r\n                          <Label>Product Name</Label>\r\n                          <Input\r\n                            type=\"text\"\r\n                            name=\"Product_Title\"\r\n                            readOnly\r\n                            placeholder=\"Product Name\"\r\n                            value={item?.productId?.Product_Title}\r\n                          />\r\n                        </div>\r\n                      </Col>\r\n                      <Col className=\"mb-1\" lg=\"2\" md=\"2\" sm=\"12\">\r\n                        <div className=\"\">\r\n                          <Label>Price</Label>\r\n                          <Input\r\n                            type=\"text\"\r\n                            name=\"price\"\r\n                            readOnly\r\n                            placeholder=\"Price\"\r\n                            value={item?.productId?.Product_MRP}\r\n                          />\r\n                        </div>\r\n                      </Col>\r\n                      <Col className=\"mb-1\" lg=\"2\" md=\"2\" sm=\"12\">\r\n                        <div className=\"\">\r\n                          <Label>Purchased Quantity</Label>\r\n                          <Input\r\n                            type=\"number\"\r\n                            readOnly\r\n                            name=\"qty\"\r\n                            placeholder=\"Req_Qty\"\r\n                            value={item?.qty * item?.Size}\r\n                            onChange={(e) =>\r\n                              handleProductChangeProduct(e, index)\r\n                            }\r\n                          />\r\n                        </div>\r\n                      </Col>\r\n                      <Col className=\"mb-1\" lg=\"2\" md=\"2\" sm=\"12\">\r\n                        <div className=\"\">\r\n                          <Label>UnitType</Label>\r\n                          <Input\r\n                            type=\"text\"\r\n                            readOnly\r\n                            name=\"unitType\"\r\n                            placeholder=\"unit Type\"\r\n                            value={item?.unitType}\r\n                            onChange={(e) =>\r\n                              handleProductChangeProduct(e, index)\r\n                            }\r\n                          />\r\n                        </div>\r\n                      </Col>\r\n                      <Col className=\"mb-1\" lg=\"2\" md=\"2\" sm=\"12\">\r\n                        <div className=\"\">\r\n                          <Label>Return Quantity</Label>\r\n                          <Input\r\n                            min={0}\r\n                            max={item?.qty * item?.Size - 1}\r\n                            type=\"number\"\r\n                            name=\"returnQty\"\r\n                            placeholder=\"Return Quantity\"\r\n                            value={OrderedListData?.returnQty}\r\n                            onChange={(e) =>\r\n                              handleProductChangeProduct(e, index)\r\n                            }\r\n                          />\r\n                        </div>\r\n                      </Col>\r\n                    </Row>\r\n                  );\r\n                })}\r\n              <Row>\r\n                <Col className=\"mb-1\" lg=\"12\" md=\"12\" sm=\"12\">\r\n                  <div className=\" d-flex justify-content-end\">\r\n                    <Label className=\"pr-5\">\r\n                      Grand Total :\r\n                      <strong>\r\n                        {grandTotalAmt && grandTotalAmt == \"NaN\"\r\n                          ? 0\r\n                          : grandTotalAmt}\r\n                      </strong>\r\n                    </Label>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n              <Row>\r\n                <Col>\r\n                  <div className=\"d-flex justify-content-center\">\r\n                    <Button.Ripple\r\n                      color=\"primary\"\r\n                      type=\"submit\"\r\n                      className=\"mt-2\">\r\n                      Submit\r\n                    </Button.Ripple>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </Form>\r\n          </CardBody>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default SalesReturnView;\r\n"],"sourceRoot":""}